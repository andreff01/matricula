{% extends 'base.html' %}
{% block title %}Lista de Alunos{% endblock %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h4">Alunos</h1>
  <a class="btn btn-primary" href="/novo/"><i class="bi bi-plus-lg"></i> Cadastrar Aluno</a>
</div>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-4">
    <input type="text" name="nome" value="{{ nome }}" class="form-control" placeholder="Buscar por nome">
  </div>
  <div class="col-md-3">
    <select name="status" class="form-select">
      <option value="">Status (todos)</option>
      <option value="ativo" {% if status == 'ativo' %}selected{% endif %}>Ativo</option>
      <option value="inativo" {% if status == 'inativo' %}selected{% endif %}>Inativo</option>
    </select>
  </div>
  <div class="col-md-2">
    <button type="submit" class="btn btn-outline-primary w-100">Filtrar</button>
  </div>
</form>

<div class="mb-2 text-muted small">
  Mostrando {{ start }}-{{ end }} de {{ total }} itens
</div>

<div class="list-group">
  {% for aluno in alunos %}
  <div class="list-group-item d-flex align-items-center justify-content-between">
    <div>
      <div class="fw-bold">{{ aluno.numero_matricula }} — {{ aluno.nome }}</div>
      <div class="text-muted small">{{ aluno.curso }} · {{ aluno.serie }} · CPF: {{ aluno.cpf }}</div>
    </div>
    <div class="text-end">
      {% if aluno.turno == 'manha' %}
        <span class="badge bg-warning me-1">Manhã</span>
      {% elif aluno.turno == 'tarde' %}
        <span class="badge bg-info text-dark me-1">Tarde</span>
      {% elif aluno.turno == 'noite' %}
        <span class="badge bg-dark me-1">Noite</span>
      {% elif aluno.turno == 'integral' %}
        <span class="badge bg-primary me-1">Integral</span>
      {% endif %}
      {% if aluno.status == 'ativo' %}
        <span class="badge bg-success me-2">Ativo</span>
      {% else %}
        <span class="badge bg-danger me-2">Inativo</span>
      {% endif %}
      <a class="btn btn-sm btn-outline-info me-1" href="{% url 'aluno_detail' aluno.pk %}"><i class="bi bi-eye"></i></a>
      <a class="btn btn-sm btn-outline-warning me-1" href="{% url 'aluno_update' aluno.pk %}"><i class="bi bi-pencil"></i></a>
      <a class="btn btn-sm btn-outline-danger" href="{% url 'aluno_delete' aluno.pk %}"><i class="bi bi-trash"></i></a>
    </div>
  </div>
  {% empty %}
  <div class="list-group-item">Nenhum aluno cadastrado.</div>
  {% endfor %}
</div>

<nav class="mt-3">
  <ul class="pagination justify-content-center">
    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?{% if nome %}nome={{ nome|urlencode }}&{% endif %}{% if status %}status={{ status|urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}">Anterior</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Anterior</span></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span></li>
    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?{% if nome %}nome={{ nome|urlencode }}&{% endif %}{% if status %}status={{ status|urlencode }}&{% endif %}page={{ page_obj.next_page_number }}">Próxima</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Próxima</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
